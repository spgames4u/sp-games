/* ══════════════════════════════════════
   أغاني سكور بوينت - Song Quiz
   ScoreLand Game - Dark Theme
   ══════════════════════════════════════ */

:root {
    --bg: #0b0e1a;
    --surface: #131832;
    --surface2: #1a2040;
    --surface3: #1e2550;
    --gold: #d4a930;
    --emerald: #22c55e;
    --danger: #ef4444;
    --text: #f0f0f5;
    --text-dim: rgba(255,255,255,.35);
    --text-mid: rgba(255,255,255,.6);
    --border: rgba(255,255,255,.06);
    --accent: #8b5cf6;
}

* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html, body { width: 100%; height: 100%; overflow: hidden; font-family: 'Cairo', sans-serif; background: var(--bg); color: var(--text); }

.screen { display: none; position: fixed; inset: 0; justify-content: center; align-items: center; }
.screen.on { display: flex; }

.hidden { display: none !important; }

/* ══════ S0: تحميل ══════ */
.loader-wrap { text-align: center; }
.music-loader { display: flex; gap: 4px; justify-content: center; align-items: flex-end; height: 40px; margin-bottom: 16px; }
.music-loader span { width: 5px; background: var(--accent); border-radius: 3px; animation: musicBar 1s ease-in-out infinite; }
.music-loader span:nth-child(1) { height: 12px; animation-delay: 0s; }
.music-loader span:nth-child(2) { height: 24px; animation-delay: .15s; }
.music-loader span:nth-child(3) { height: 36px; animation-delay: .3s; }
.music-loader span:nth-child(4) { height: 24px; animation-delay: .45s; }
.music-loader span:nth-child(5) { height: 12px; animation-delay: .6s; }
@keyframes musicBar {
    0%, 100% { transform: scaleY(.4); }
    50% { transform: scaleY(1); }
}
.loader-wrap p { font-size: .85rem; color: var(--text-mid); font-weight: 600; }

/* ══════ Game Layout ══════ */
.game-layout {
    width: 100%; max-width: 480px; height: 100%; margin: 0 auto;
    display: flex; flex-direction: column; padding: 6px 10px; gap: 6px; overflow-y: auto; overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
}

.game-hdr { flex-shrink: 0; text-align: center; padding: 4px 0; }
.hdr-title { font-size: .85rem; font-weight: 700; color: var(--text); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* ══════ Video Section ══════ */
.video-section { flex-shrink: 0; border-radius: 12px; overflow: hidden; background: #000; border: 1px solid var(--border); }

.video-container { position: relative; width: 100%; aspect-ratio: 16/9; background: #000; cursor: pointer; }
.video-container video { width: 100%; height: 100%; object-fit: contain; display: block; }

.video-overlay { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,.4); transition: opacity .2s; }
.video-overlay.hide { opacity: 0; pointer-events: none; }

.play-big-btn {
    width: 56px; height: 56px; border-radius: 50%; border: none;
    background: rgba(139,92,246,.85); color: #fff; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: transform .15s, background .15s;
}
.play-big-btn:active { transform: scale(.9); }

/* Controls */
.video-controls { padding: 4px 8px 6px; background: var(--surface); }

.progress-track {
    width: 100%; height: 6px; background: rgba(255,255,255,.1); border-radius: 3px;
    position: relative; cursor: pointer; margin-bottom: 6px;
}
.progress-played { height: 100%; background: var(--accent); border-radius: 3px; width: 0; pointer-events: none; }
.progress-handle {
    position: absolute; top: 50%; width: 14px; height: 14px; border-radius: 50%;
    background: var(--accent); border: 2px solid #fff; transform: translate(-50%, -50%);
    left: 0; opacity: 0; transition: opacity .15s; pointer-events: none;
}
.progress-track:hover .progress-handle, .progress-track.dragging .progress-handle { opacity: 1; }

.controls-row { display: flex; align-items: center; gap: 6px; }

.ctrl-btn {
    background: none; border: none; color: var(--text-mid); cursor: pointer;
    width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;
    border-radius: 6px; transition: color .15s, background .15s; flex-shrink: 0;
}
.ctrl-btn:hover { color: var(--text); background: rgba(255,255,255,.06); }

.time-display { font-size: .65rem; color: var(--text-dim); font-variant-numeric: tabular-nums; white-space: nowrap; min-width: 70px; }

.speed-btn { width: auto !important; padding: 0 6px; font-size: .65rem; font-weight: 700; font-family: 'Cairo', sans-serif; color: var(--accent); }

.volume-ctrl { display: flex; align-items: center; gap: 2px; margin-inline-start: auto; }
.vol-slider {
    width: 50px; height: 4px; -webkit-appearance: none; appearance: none;
    background: rgba(255,255,255,.15); border-radius: 2px; cursor: pointer; outline: none;
}
.vol-slider::-webkit-slider-thumb {
    -webkit-appearance: none; width: 12px; height: 12px; border-radius: 50%;
    background: var(--text); cursor: pointer;
}
.vol-slider::-moz-range-thumb { width: 12px; height: 12px; border-radius: 50%; background: var(--text); cursor: pointer; border: none; }

/* Fullscreen */
.video-container.fullscreen { position: fixed; inset: 0; z-index: 999; aspect-ratio: auto; border-radius: 0; }
.video-container.fullscreen + .video-controls { position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000; border-radius: 0; }

/* ══════ Questions Section ══════ */
.questions-section { flex: 1; display: flex; flex-direction: column; gap: 8px; min-height: 0; }

.listen-label { font-size: .75rem; font-weight: 700; color: var(--accent); text-align: center; padding: 4px 0; }

.questions-list { display: flex; flex-direction: column; gap: 6px; }

.q-row {
    display: flex; align-items: center; gap: 8px;
    background: var(--surface); border: 1px solid var(--border); border-radius: 10px;
    padding: 8px 12px; transition: border-color .2s;
}
.q-row.wrong { border-color: var(--danger); animation: shake .4s ease; }
.q-row.correct { border-color: var(--emerald); }

.q-num { font-size: .65rem; font-weight: 800; color: var(--accent); background: rgba(139,92,246,.12); width: 22px; height: 22px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
.q-text { flex: 1; font-size: .78rem; font-weight: 600; color: var(--text); }
.q-input {
    width: 52px; height: 36px; border: 1.5px solid rgba(255,255,255,.1); border-radius: 8px;
    background: var(--surface2); color: var(--text); text-align: center; font-size: .9rem;
    font-weight: 700; font-family: 'Cairo', sans-serif; outline: none; flex-shrink: 0;
    -moz-appearance: textfield;
}
.q-input::-webkit-outer-spin-button, .q-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
.q-input:focus { border-color: var(--accent); box-shadow: 0 0 0 2px rgba(139,92,246,.2); }
.q-row.wrong .q-input { border-color: var(--danger); }
.q-row.correct .q-input { border-color: var(--emerald); background: rgba(34,197,94,.08); }

.check-btn {
    width: 100%; padding: 10px; border: none; border-radius: 10px; cursor: pointer;
    background: linear-gradient(135deg, var(--accent), #7c3aed); color: #fff;
    font-size: .85rem; font-weight: 700; font-family: 'Cairo', sans-serif;
    transition: transform .1s, opacity .15s; flex-shrink: 0;
}
.check-btn:active { transform: scale(.97); }
.check-btn:disabled { opacity: .5; cursor: not-allowed; }

/* ══════ Toast ══════ */
.toast-box { position: fixed; top: 50%; left: 50%; transform: translate(-50%,-50%); z-index: 200; pointer-events: none; }
.toast { background: rgba(19,24,50,.95); border: 1.5px solid var(--border); border-radius: 11px; padding: 10px 18px; font-size: .76rem; font-weight: 700; animation: toastIn .25s ease; backdrop-filter: blur(8px); text-align: center; max-width: 280px; }
.toast.success { border-color: rgba(34,197,94,.2); color: var(--emerald); }
.toast.error   { border-color: rgba(239,68,68,.15); color: var(--danger); }
.toast.info    { border-color: rgba(139,92,246,.15); color: var(--accent); }
@keyframes toastIn { 0%{transform:scale(.7);opacity:0} 100%{transform:scale(1);opacity:1} }

/* ══════ S2: النتيجة ══════ */
.result-card { text-align: center; padding: 30px; }
.result-glow { position: absolute; width: 200px; height: 200px; border-radius: 50%; filter: blur(60px); opacity: .15; top: 50%; left: 50%; transform: translate(-50%,-50%); pointer-events: none; }
.result-icon { width: 70px; height: 70px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: 900; margin: 0 auto 16px; }
.result-icon.ok { background: rgba(34,197,94,.12); border: 2px solid rgba(34,197,94,.2); color: var(--emerald); }
.result-icon.no { background: rgba(239,68,68,.1); border: 2px solid rgba(239,68,68,.15); color: var(--danger); }
.result-title { font-size: 1.1rem; font-weight: 800; margin-bottom: 8px; }
.result-title.ok { color: var(--emerald); }
.result-title.no { color: var(--danger); }
.result-coins { display: inline-flex; align-items: center; gap: 6px; padding: 6px 16px; border-radius: 20px; font-size: .9rem; font-weight: 800; color: var(--gold); background: rgba(212,169,48,.12); margin-bottom: 12px; }
.result-next { font-size: .75rem; color: var(--text-dim); margin-top: 12px; }

/* ══════ Animations ══════ */
@keyframes shake { 0%,100%{transform:translateX(0)} 20%{transform:translateX(-4px)} 40%{transform:translateX(4px)} 60%{transform:translateX(-3px)} 80%{transform:translateX(3px)} }

/* ══════ Responsive ══════ */
@media (max-width: 360px) {
    .game-layout { padding: 4px 6px; gap: 4px; }
    .hdr-title { font-size: .78rem; }
    .q-text { font-size: .72rem; }
    .q-input { width: 46px; height: 32px; font-size: .82rem; }
    .check-btn { padding: 8px; font-size: .8rem; }
    .listen-label { font-size: .7rem; }
    .play-big-btn { width: 46px; height: 46px; }
    .play-big-btn svg { width: 38px; height: 38px; }
}

@media (max-height: 620px) {
    .game-layout { gap: 4px; padding: 3px 8px; }
    .game-hdr { padding: 2px 0; }
    .q-row { padding: 6px 10px; }
    .video-controls { padding: 3px 6px 4px; }
    .listen-label { padding: 2px 0; }
    .check-btn { padding: 8px; }
}

@media (max-height: 550px) {
    .hdr-title { font-size: .72rem; }
    .listen-label { font-size: .65rem; padding: 1px 0; }
    .q-row { padding: 5px 8px; gap: 6px; border-radius: 8px; }
    .q-text { font-size: .68rem; }
    .q-input { width: 42px; height: 30px; font-size: .78rem; }
    .check-btn { padding: 7px; font-size: .75rem; border-radius: 8px; }
    .vol-slider { width: 36px; }
}

/* Desktop wider */
@media (min-width: 600px) {
    .video-container { max-height: 260px; }
}
